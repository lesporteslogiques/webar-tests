<!doctype html>
<html>
    <head>
        <title>My first ar experience </title>
        <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
        <!-- On ajoute un fichier js pour permettre la réalité augmentée -->
        <script src="https://raw.githack.com/AR-js-org/AR.js/3.4.5/aframe/build/aframe-ar.js"></script>
    </head>

    <body style="margin : 0px; overflow: hidden;">
        
        <!-- Tout ces attributs dans la balise <a-scene> permettent, globalement, d'être en mode réalité augmentée, en définissant
            la source comme étant la caméra, entre autre. Certains paramètres me sont encore inconnus, mais ça marche. -->
        <a-scene 
        embedded arjs="sourceType: webcam;"
        vr-mode-ui="enabled: false" 
        renderer="sortObjects: true; antialias: true; logarithmicDepthBuffer: true;"
        arjs="trackingMethod: best;
        detectionMode :'color_and_matrix' 
        changeMatrixMode: 'modelViewMatrix'; "
        smooth="true" smoothCount="5" smoothTolerance=".05" smoothThreshold="5" 
        sourceWidth= "800" sourceHeight= "600"
        displayWidth= "1280" displayHeight="720" >

        <!-- On peut définir des assets et les utiliser dans notre scène au lieu de devoir tout écrire plusieurs fois. Le principe est
         similaire à une fonction qui nous éviterait d'avoir à réécrire plusieurs fois le même code. -->
         <a-assets>

             <!-- Le readme de l'introduction à A-Frame part du principe que les assets sont stockés sur le serveur.
             Pour éviter de prendre plus d'espace que nécessaire, je me contente de sourcer le lien vers la texture. -->
            <img id="leavestex" src="https://dl.polyhaven.org/file/ph-assets/Textures/jpg/1k/forest_leaves_02/forest_leaves_02_diffuse_1k.jpg">

            <!-- L'id d'un <a-mixin> servira aux <a-entity> pour utiliser l'asset correspondant. -->
            <a-mixin id="brown" material="color: brown"></a-mixin>
            <a-mixin id="lightgreen" material="color:#a5d152 "></a-mixin>
            <a-mixin id="trunk" geometry="primitive: box ; width:.25; height:1; depth:.25"></a-mixin>
            <a-mixin id="treetop" geometry="primitive: cone ; radius-bottom:.5; radius-top:0"></a-mixin>
        </a-assets>

            <a-marker preset="kanji" size= "0.08">

                <!-- Ici, "brown trunk" permet d'avoir un asset de type "box" et de couleur marron -->
                <a-entity mixin="brown trunk" position="0 .5 0"></a-entity>

                <a-entity mixin="lightgreen treetop" position="0 1.5 0"></a-entity>
                <a-plane position="0 0 0" rotation="-90 0 0" width="4" height="4" material="src: #leavestex;"></a-plane>
            </a-marker>

            <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>
        </a-scene>
    </body>
</html>